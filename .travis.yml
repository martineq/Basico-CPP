# Selección del lenguaje: C++
language: cpp

# Seleeción de compiladores
compiler:
  - gcc

before_install:
  - mkdir home
  - mkdir -p usr/local/lib

#Instalacíón 
install:
  - sudo apt-get update -qq
  - sudo apt-get install -y -qq lcov curl build-essential python git cmake wget unzip valgrind tree
  - sudo apt-get install -y -qq libsnappy-dev zlib1g-dev libbz2-dev
  - wget https://gflags.googlecode.com/files/libgflags0_2.0-1_amd64.deb
  - sudo dpkg -i libgflags0_2.0-1_amd64.deb
  - wget https://gflags.googlecode.com/files/libgflags-dev_2.0-1_amd64.deb
  - sudo dpkg -i libgflags-dev_2.0-1_amd64.deb
  - cd /home
  - wget https://github.com/facebook/rocksdb/archive/master.zip
  - unzip master.zip
  - cd rocksdb-master
  - make static_lib
  - sudo cp librocksdb.a /usr/local/lib
  - cd ..
  - rm -rf rocksdb-master
  - rm master.zip
  - wget https://github.com/cesanta/mongoose/archive/master.zip
  - unzip master.zip
  - cd mongoose-master
  - gcc -c mongoose.c
  - ar rvs libmongoose.a mongoose.o
  - sudo cp libmongoose.a /usr/local/lib
  - cd ..
  - rm -rf mongoose-master
  - rm master.zip
  - wget https://github.com/open-source-parsers/jsoncpp/archive/master.zip
  - unzip master.zip
  - cd jsoncpp-master
  - python amalgamate.py
  - cd dist
  - gcc -c jsoncpp.cpp
  - ar rvs libjsoncpp.a jsoncpp.o
  - sudo cp libjsoncpp.a /usr/local/lib
  - cd ../..
  - rm -rf jsoncpp-master
  - rm master.zip
  - cd -


before_script:
  - mkdir build

script: 
  - cd build
  - tree -L 2 -d
  - cmake -DCOVERALLS=ON -DCMAKE_BUILD_TYPE=Debug ..
  - make
  - make coveralls
